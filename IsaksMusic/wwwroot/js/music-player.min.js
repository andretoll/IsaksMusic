function setVolume(n){n===0?($("#volumeMenuButton").children("i").removeClass("fa-volume-down"),$("#volumeMenuButton").children("i").removeClass("fa-volume-up"),$("#volumeMenuButton").children("i").addClass("fa-volume-off")):n<.75?($("#volumeMenuButton").children("i").removeClass("fa-volume-off"),$("#volumeMenuButton").children("i").removeClass("fa-volume-up"),$("#volumeMenuButton").children("i").addClass("fa-volume-down")):n>=.75&&($("#volumeMenuButton").children("i").removeClass("fa-volume-off"),$("#volumeMenuButton").children("i").removeClass("fa-volume-down"),$("#volumeMenuButton").children("i").addClass("fa-volume-up"));wavesurfer.setVolume(n)}function playNext(){var t,n;if(queueList.length>0?(n=playlist[queueList[0]-1],queueList.shift()):shuffle===!0&&playlist.length>1?(t=generateRandom(1,playlist.length,currentSong),n=playlist[t-1],currentSong=t):(currentSong++,n=playlist[currentSong-1]),n===undefined)if(repeat===!0)n=playlist[0];else return;loadSong(n.playlistId)}function loadSong(n){$("#waveformMessage").show();$("#waveformMessage").text("Loading track...");var t=playlist.filter(function(t){return t.playlistId===n})[0];wavesurfer.load(t.filePath);currentSong=t.playlistId;$("#songPlayingTitle").html(t.title);$("#songPlayingCategories").html(t.categories);currentSongElement=document.getElementById(n);$("#musicTable > tbody > tr").each(function(){$(this).removeClass("song-active")});$(currentSongElement).addClass("song-active");addStatistics(t.songId)}function playPause(){wavesurfer.isPlaying()?(wavesurfer.pause(),$("#playPauseBtn").children("i").removeClass("fa-pause-circle"),$("#playPauseBtn").children("i").addClass("fa-play-circle")):(wavesurfer.play(),$("#playPauseBtn").children("i").removeClass("fa-play-circle"),$("#playPauseBtn").children("i").addClass("fa-pause-circle"))}function formatTime(n){return[Math.floor(n%3600/60),("00"+Math.floor(n%60)).slice(-2)].join(":")}function mousetooltiptime(n){var i=event.layerX/$("#waveform").width(),t=formatTime(Math.floor(wavesurfer.getDuration()*i));wavesurfer.getCurrentTime()!==0&&(n===!1?$(".tooltip-track").text(t).css("display","none"):$(".tooltip-track").text(t).css("left",n.pageX+25).css("top",n.pageY-25).css("display","block"))}function generateRandom(n,t,i){var r=Math.floor(Math.random()*(t-n+1))+n;return r===i?generateRandom(n,t,i):r}function updateGradient(){if($!==undefined){var t=colors[colorIndices[0]],i=colors[colorIndices[1]],r=colors[colorIndices[2]],u=colors[colorIndices[3]],n=1-step,o=Math.round(n*t[0]+step*i[0]),s=Math.round(n*t[1]+step*i[1]),h=Math.round(n*t[2]+step*i[2]),f="rgb("+o+","+s+","+h+")",c=Math.round(n*r[0]+step*u[0]),l=Math.round(n*r[1]+step*u[1]),a=Math.round(n*r[2]+step*u[2]),e="rgb("+c+","+l+","+a+")";$("#waveformContainer").css({background:"-webkit-gradient(linear, left top, right top, from("+f+"), to("+e+"))"}).css({background:"-moz-linear-gradient(left, "+f+" 0%, "+e+" 100%)"}).css({background:"linear-gradient(left"+f+","+e+")"});step+=gradientSpeed;step>=1&&(step%=1,colorIndices[0]=colorIndices[1],colorIndices[2]=colorIndices[3],colorIndices[1]=(colorIndices[1]+Math.floor(1+Math.random()*(colors.length-1)))%colors.length,colorIndices[3]=(colorIndices[3]+Math.floor(1+Math.random()*(colors.length-1)))%colors.length)}}function addToQueueList(n){queueList.length<queueLimit&&(queueList.push(n),$("#clearQueueBtn").attr("data-original-title","Added to queue").tooltip("show"));queueList.length===queueLimit&&$("#clearQueueBtn").attr("data-original-title","Queue limit reached").tooltip("show");setTimeout(function(){$("#clearQueueBtn").tooltip("hide")},2e3)}function clearQueueList(){queueList.length>0&&(queueList=[],$("#clearQueueBtn").attr("data-original-title","Queue cleared").tooltip("show"));setTimeout(function(){$("#clearQueueBtn").tooltip("hide")},2e3)}function clearFilters(){for(var i,r=$("#musicTable"),t=$("#musicTable > tbody > tr"),n=0;n<t.length;n++)i=$(t[n]).find(".categoryColumn"),t[n].style.display="";$("input").iCheck("uncheck");$("#songListFilters").collapse("toggle");$("#songListFiltersBtn").removeClass("filter-active")}function applyFilters(){for(var s,t,n,e,u,o,f=$("#songListFilters").find("input"),i=[],r=0;r<f.length;r++)$(f[r]).is(":checked")&&i.push(f[r].id);for(i.length===0?$("#songListFiltersBtn").removeClass("filter-active"):$("#songListFiltersBtn").addClass("filter-active"),s=$("#musicTable"),t=$("#musicTable > tbody > tr"),n=0;n<t.length;n++){if(e=$(t[n]).find(".categoryColumn"),i.length===0){t[n].style.display="";continue}for(u=0;u<i.length;u++)if(o=$(e).html(),o.indexOf(i[u])>=0){t[n].style.display="";break}else t[n].style.display="none"}}function shareTrack(n){console.log(location.href+"/track/"+n);FB.ui({method:"share",href:location.href+"/track/"+n},function(){})}function addStatistics(n){$.ajax({type:"Post",url:"/api/statistics?AddTrackCount",data:{id:n},headers:{RequestVerificationToken:$('input:hidden[name="__RequestVerificationToken"]').val()},success:function(){},error:function(n){console.log(n)}})}var wavesurfer=$("#waveform"),currentSong,repeat,shuffle,playlist,ccInterval,queueList=[],queueLimit=7,colors=[[62,35,255],[60,255,60],[255,35,98],[45,175,230],[255,0,255],[255,128,0]],step=0,colorIndices=[0,1,2,3],gradientSpeed=.002;$(document).ready(function(){repeat=!1;shuffle=!1;currentSong=1;$("#playPauseBtn").on("click",function(){wavesurfer.getDuration()===0?loadSong(playlist[0].playlistId):playPause()});$("#toggleRepeat").on("click",function(){repeat=$(this).attr("aria-pressed")==="true"?!1:!0});$("#toggleShuffle").on("click",function(){shuffle=$(this).attr("aria-pressed")==="true"?!1:!0});$("#togglePulse").on("click",function(){$(this).attr("aria-pressed")==="true"?(clearInterval(ccInterval),$("#waveformContainer").removeAttr("Style"),$("#waveformControls").removeClass("pulse")):(ccInterval=setInterval(updateGradient,10),$("#waveformControls").addClass("pulse"))});$("input[type=checkbox]").iCheck({checkboxClass:"icheckbox_square-red",radioClass:"iradio_square-red",increaseArea:"20%"});$("#volumeSlider").slider({min:0,max:100,value:50,range:"min",slide:function(n,t){setVolume(t.value/100)}});ccInterval=setInterval(updateGradient,10);$("#waveformControls").addClass("pulse");wavesurfer.setVolume(.5)});wavesurfer=WaveSurfer.create({container:"#waveform",waveColor:"white",progressColor:"#ffc600",barHeight:2,barWidth:3,cursorWidth:0,responsive:!0,hideScrollbar:!0});wavesurfer.on("finish",function(){$("#playPauseBtn").children("i").removeClass("fa-pause-circle");$("#playPauseBtn").children("i").addClass("fa-play-circle");playNext()});wavesurfer.on("ready",function(){$("#waveformDuration").text(formatTime(wavesurfer.getDuration()));$("#waveformMessage").hide();playPause()});wavesurfer.on("audioprocess",function(){$("#waveformCounter").text(formatTime(wavesurfer.getCurrentTime()))});wavesurfer.on("seek",function(){wavesurfer.getDuration()!==0&&$("#waveformCounter").text(formatTime(wavesurfer.getCurrentTime()))});$("#waveform").on("mousemove",function(n){mousetooltiptime(n)});$("#waveform").on("mouseleave",function(){mousetooltiptime(!1)});